<!DOCTYPE html>
<html lang="en">
    <head>
        <title>SwitchPad</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            *{
                margin: 0;
                padding: 0;
            }
            html{
                width: 100%;
            }
            body{
                overflow-x: hidden;
                background: purple;
                display: flex; 
                min-height: 100vh;           
            }
            .video{
                background: #221F24;
                text-align: center;            
                grid-area: video;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .mandoL,.mandoR{
                text-align: center;              
                width: 20vw;
                display:flex;
                justify-content: center;
                align-items: flex-end;
            }            
            .grid-container {
                display: grid;
                height: 100vh;
                width: 100vw;
            }
            button{
                background-color: #707372;
                border: none;
                cursor: pointer;
                padding: 0;
            }
            .arrow{
                width: 0; 
                height: 0; 
                margin: auto;
                border-left: var(--bleft);
                border-right: var(--bright);
                border-bottom: var(--bbottom);
                border-top: var(--btop);
            }
            .circle{
                background: #212324;
                border-radius: 50%;
                margin: auto;
            }
            .cmd{
                background: #6A6367;           
                text-align: center;
                color:white;
                display: flex;                  
            } 
            .cmd .cmd_contenido{
                display: flex; 
                flex-direction: column; 
                justify-content: space-evenly;
            }
            .cmd .vbtn{
                height: 5vh;
                border:1px solid #6A6367;
                background-color: whitesmoke;                    
            } 
            .cmd .msgComandos{
                width: 14vw;
                text-align: center;
                color: white;
            }          
            @media (orientation: landscape) {
                body {
                    flex-direction: row;                  
                }
                .video{
                    height: 85.3125vh;
                    width: 60vw;
                }
                .video img{  
                    width: auto ;
                    max-width: 60vw ;
                    height:  auto;
                    max-height: 80vh;                    
                }
                .mandoL{
                    background: #06BADD;
                    grid-area: mandoL;
                }
                .mandoR{
                    background: #F56E64;              
                    grid-area: mandoR;
                }
                .alineacionR{
                    display: flex;
                    padding-bottom: calc( (19.5/9)*9vh );
                }
                .alineacionL{
                    display: flex;
                    padding-bottom: calc( (19.5/9)*3vh );
                }
                .mandoGral{
                    display: none;
                }                
                button{
                    width: calc( (19.5/9)*6vh );
                    height: calc( (19.5/9)*6vh );
                    border-radius: var(--brbtn);
                }
                .circle{
                    width: 4vh;
                    height: 4vh;
                }
                .grid-container {
                    grid-template-rows: repeat(6, 1fr);
                    grid-template-columns: repeat(12, 1fr);
                    grid-template-areas:
                    "mandoL mandoL  land      land    land      land    land      land    land    land    mandoR mandoR"
                    "mandoL mandoL  land      land    land      land    land      land    land    land    mandoR mandoR"
                    "mandoL mandoL  video     video   video     video   video     video   video   video    mandoR mandoR"
                    "mandoL mandoL  video     video   video     video   video     video   video   video    mandoR mandoR"
                    "mandoL mandoL  video     video   video     video   video     video   video   video     mandoR mandoR"
                    "mandoL mandoL  video     video   video     video   video     video   video   video     mandoR mandoR";
                }
                .cmd{           
                    grid-area: land;
                    height: 14.6875vh;
                    width: 60vw;;                   
                }
                .cmd .cmd_contenido{
                    width: 32vw;
                }
                .cmd .vbtn{
                    width: 4.2vw;   
                }
                .cmd .msgComandos{
                    font-size:4vh; 
                    height: 14.6875vh;                  
                }
                .cmd .titulo{
                    font-size: 4vh;
                }
                .CENTER{
                    display: flex;
                    flex-direction: column;
                }
            }

            @media (orientation: portrait) {
                body {
                    flex-direction: column;
                }
                .video{
                    height: 50vh;
                }
                .video img{  
                    width: auto ;
                    max-width: 100% ;
                    height: 50vh ; 
                }                
                .mandoGral{
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    background: #aaaaaa;                             
                    grid-area: mandoGral;
                    height: 40vh;
                }
                .mandoL, .mandoR{
                    display: none;
                }
                button{
                    width: calc( (19.5/9)*5.5vh );
                    height: calc( (19.5/9)*5.5vh );
                    border-radius: var(--brbtn);
                }
                .grid-container {
                    grid-template-rows: repeat(12, 1fr);
                    grid-template-columns: repeat(12, 1fr);
                    grid-template-areas:
                    "video      video     video     video     video     video     video     video     video     video     video     video"
                    "video      video     video     video     video     video     video     video     video     video     video     video"
                    "video      video     video     video     video     video     video     video     video     video     video     video"
                    "video      video     video     video     video     video     video     video     video     video     video     video"
                    "video      video     video     video     video     video     video     video     video     video     video     video"
                    "video      video     video     video     video     video     video     video     video     video     video     video"
                    "comandosGral   comandosGral  comandosGral comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral"
                    "comandosGral   comandosGral  comandosGral comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral  comandosGral"
                    "mandoGral  mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral"
                    "mandoGral  mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral"
                    "mandoGral  mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral"
                    "mandoGral  mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral mandoGral";
                }
                .circle{
                    width: 6vh;
                    height: 6vh;
                }
                .central{
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }
                .CENTER{
                    display: flex;
                    flex-direction: column;
                }
                .LEFT,.RIGHT{
                    margin: auto 0;
                }
                .cmd{           
                    grid-area: comandosGral;
                    height: 10vh;
                    width: 100vw;                   
                }
                .cmd .cmd_contenido{
                    width: 72vw;
                }
                .cmd .vbtn{
                    width: 7.2vw;    
                }
                .cmd .msgComandos{
                    font-size:4vw;
                    height: 10vh;
                }
                .cmd .titulo{
                    font-size: 4vw;
                }
            }
        </style>
    </head>
    <body ontouchstart="">       
        <div class="grid-container">
            <div class="mandoL">
                <div class="alineacionL">
                    <div class="LEFT" style="display: flex; align-items: flex-start;">
                        <button id="btnL" onpointerdown="togglePush('btnL','left','#a396ed')" onpointerup="togglePush('btnL','stop','#707372')" style="--brbtn: 2.5vh 0px 0px 2.5vh;" name="gamepad">
                            <div class="arrow" style="--btop: 1.5vh solid transparent;--bbottom: 1.5vh solid transparent; --bright: 1.5vh solid #212324; --bleft:none" ></div>   
                        </button> 
                    </div>
                    <div class="CENTER">
                        <button id="btnStopL" onpointerdown="togglePush('btnStopL','stop','#a396ed')" onpointerup="togglePush('btnStopL','stop','#707372')" style="--brbtn: 0px 6vh 0px 0px;">
                            <div class="circle"></div>
                        </button>    
                        <button id="btnB" onpointerdown="togglePush('btnB','backward','#a396ed')" onpointerup="togglePush('btnB','stop','#707372')" style="--brbtn: 0px 0px 2.5vh 2.5vh;" name="gamepad">
                            <div class="arrow" style="--bleft: 1.5vh solid transparent;--bright: 1.5vh solid transparent; --bbottom: none; --btop:1.5vh solid #212324" ></div>
                        </button>
                    </div>
                </div>
            </div>
            <div class="mandoR">
                <div class="alineacionR">
                    <div class="CENTER">
                        <button id="btnU" onpointerdown="togglePush('btnU','forward','#a396ed')" onpointerup="togglePush('btnU','stop','#707372')" style="--brbtn: 2.5vh 2.5vh 0px 0px;" name="gamepad">
                            <div class="arrow" style="--bleft: 1.5vh solid transparent;--bright: 1.5vh solid transparent; --bbottom: 1.5vh solid #212324; --btop:none" ></div>
                        </button>
                        <button id="btnStopR" onpointerdown="togglePush('btnStopR','stop','#a396ed')" onpointerup="togglePush('btnStopR','stop','#707372')" style="--brbtn: 0px 0px 0px 6vh">
                            <div class="circle"></div>
                        </button>
                    </div>                        
                    <div class="RIGHT" style="display: flex; align-items: flex-end;">
                        <button id="btnR" onpointerdown="togglePush('btnR','right','#a396ed')" onpointerup="togglePush('btnR','stop','#707372')" style="--brbtn: 0px 2.5vh 2.5vh 0px;" name="gamepad">
                            <div class="arrow" style="--btop: 1.5vh solid transparent;--bbottom: 1.5vh solid transparent; --bright: none; --bleft:1.5vh solid #212324" ></div>   
                        </button>
                    </div>                     
                </div> 
            </div>
            <div class="video">
                <img src="" id="photo">
            </div>
            <div class="cmd">
                <button class="msgComandos" onpointerdown="decrementar()">MIN<br>-</button>
                <div class="cmd_contenido"> 
                    <div id="vel" class="titulo">VELOCIDAD</div>
                    <div style="display: flex;">
                        <div id="vbtn0" class="vbtn" name="divColor"></div> 
                        <div id="vbtn1" class="vbtn" name="divColor"></div>
                        <div id="vbtn2" class="vbtn" name="divColor"></div>
                        <div id="vbtn3" class="vbtn" name="divColor"></div>
                        <div id="vbtn4" class="vbtn" name="divColor"></div>
                        <div id="vbtn5" class="vbtn" name="divColor"></div>
                        <div id="vbtn6" class="vbtn" name="divColor"></div>
                        <div id="vbtn7" class="vbtn" name="divColor"></div>
                        <div id="vbtn8" class="vbtn" name="divColor"></div>
                        <div id="vbtn9" class="vbtn" name="divColor"></div>   
                    </div>                       
                </div>
                <button class="msgComandos" onpointerdown="incrementar()">MAX<br>+</button>                       
            </div>
            <div class="mandoGral">
                <div class="central">
                    <div class="LEFT">
                        <button id="+btnL" onpointerdown="togglePush('+btnL','left','#a396ed')" onpointerup="togglePush('+btnL','stop','#707372')" style="--brbtn: 1.5vh 0px 0px 1.5vh;" name="gamepad">
                            <div class="arrow" style="--btop: 1.5vh solid transparent;--bbottom: 1.5vh solid transparent; --bright: 1.5vh solid #212324; --bleft:none" ></div>   
                        </button> 
                    </div>
                    <div class="CENTER">
                        <button id="+btnU" onpointerdown="togglePush('+btnU','forward','#a396ed')" onpointerup="togglePush('+btnU','stop','#707372')" style="--brbtn: 1.5vh 1.5vh 0px 0px;" name="gamepad">
                            <div class="arrow" style="--bleft: 1.5vh solid transparent;--bright: 1.5vh solid transparent; --bbottom: 1.5vh solid #212324; --btop:none" ></div>
                        </button>
                        <button id="+btnStop" onpointerdown="togglePush('+btnStop','stop','#a396ed')" onpointerup="togglePush('+btnStop','stop','#707372')" style="--brbtn: none;">
                            <div class="circle"></div>
                        </button>    
                        <button id="+btnB" onpointerdown="togglePush('+btnB','backward','#a396ed')" onpointerup="togglePush('+btnB','stop','#707372')" style="--brbtn: 0px 0px 1.5vh 1.5vh;" name="gamepad">
                            <div class="arrow" style="--bleft: 1.5vh solid transparent;--bright: 1.5vh solid transparent; --bbottom: none; --btop:1.5vh solid #212324" ></div>
                        </button>
                    </div>
                    <div class="RIGHT">
                        <button id="+btnR" onpointerdown="togglePush('+btnR','right','#a396ed')" onpointerup="togglePush('+btnR','stop','#707372')" style="--brbtn: 0px 1.5vh 1.5vh 0px;" name="gamepad">
                            <div class="arrow" style="--btop: 1.5vh solid transparent;--bbottom: 1.5vh solid transparent; --bright: none; --bleft:1.5vh solid #212324" ></div>   
                        </button>
                    </div>  
                </div>
            </div>   
        </div>        
    <script>
        var clicks = 0;
        let _divColor = document.getElementsByName("divColor");
        const arrayVel = [25,50,75,100,125,150,175,200,225,250];
        let _gamepad = document.getElementsByName("gamepad");
        function incrementar() {
            if(clicks<10){ 
                clicks += 1;                 
                console.log(`Click Incremento: ${clicks}`);
                _divColor[clicks-1].style.backgroundColor = `hsl(${117-((clicks-1)*13)}, 100%, 50%)`;   
                document.getElementById("vel").innerText = `VELOCIDAD: ${arrayVel[clicks-1]}`;
                sendCommand('speed',arrayVel[clicks-1]);
            }
        }
        function decrementar() {
            if(clicks>1){
                clicks -= 1;
                console.log(`Click Decremento: ${clicks}`);
                _divColor[clicks].style.backgroundColor = '#F5F5F5';  
                document.getElementById("vel").innerText = `VELOCIDAD: ${arrayVel[clicks-1]}`;
                sendCommand('speed',arrayVel[clicks-1]);
            }                
        }
        
        function togglePush(x,y,color){
            if(x === '+btnStop' || x === 'btnStopR' || x === 'btnStopL'){
                for(let i=0;i<8;i++){
                    _gamepad[i].style.backgroundColor = color;                        
                }
                document.getElementById('+btnStop').style.backgroundColor = color;
                document.getElementById('btnStopR').style.backgroundColor = color;
                document.getElementById('btnStopL').style.backgroundColor = color;
                sendCommand('go',y);
                return 0;
            }
            for(let i=0;i<8;i++){
                if(_gamepad[i].id===x){
                    _gamepad[i].style.backgroundColor = color;
                    sendCommand('go',y);
                    return 0;
                }
            }
        }

        function sendCommand(x,y) {           
            var xhr = new XMLHttpRequest();
            xhr.open("GET", `/action?${x}=` + y, true);
            xhr.send();
        }

        window.onload = document.getElementById("photo").src = window.location.href.slice(0, -1) + ":81/stream";
    </script>
    </body>
</html>
